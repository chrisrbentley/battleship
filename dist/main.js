(()=>{"use strict";const e=document.querySelector("main");function t(t){const a=document.createElement("div");a.className="board",!0===t.isAI?a.classList.add("cpu-board"):a.classList.add("player-board"),e.appendChild(a);for(let e=0;e<t.gameboard.board.length;e+=1)for(let o=0;o<t.gameboard.board.length;o+=1){const l=document.createElement("div");l.className="cell",!0===t.isAI?l.classList.add("enemy-cell"):l.classList.add("player-cell"),l.dataset.row=e,l.dataset.col=o,a.appendChild(l)}}function a(e,t,a,o){console.log(t,a),"hit"===e.board[t][a].result?o.classList.add("hit"):o.classList.add("miss")}const o=()=>{let e=!1;const t=function e(t){const a=new Array(t||0);let o=t;if(arguments.length>1){const l=Array.prototype.slice.call(arguments,1);for(;o--;)a[t-1-o]=e.apply(this,l)}return a}(10,10);for(let e=0;e<t.length;e+=1)for(let a=0;a<t[e].length;a+=1){const o={cellHit:!1,ship:void 0,result:void 0};t[e][a]=o}const a=()=>{let a=0;for(let o=0;o<t.length;o+=1)for(let l=0;l<t[o].length;l+=1)if("object"==typeof t[o][l].ship){if(!0!==t[o][l].ship.sunk)break;if(a+=1,17===a)return e=!0,e}return e};return{board:t,placeShip:(e,a,o,l)=>{const r=(e=>{let t=0,a=!1;return{get hits(){return t},get sunk(){return a},hit:()=>(t+=1,console.log("hit!!!"),t>=e&&(a=!0,console.log("sunk!!!")),{hits:t,sunk:a})}})(l);if(t[e][a].ship=r,l>1){let n,c=1;for("horizontal"===o?n=a:"vertical"===o&&(n=e);c<l;)"horizontal"===o?(n+=1,t[e][n].ship=r,c+=1):"vertical"===o&&(n+=1,t[n][a].ship=r,c+=1);c=1}return t[e][a]},receiveAttack:(e,o)=>{if(void 0===t[e][o].ship)t[e][o].cellHit=!0,t[e][o].result="miss",a();else if(void 0!==t[e][o].ship)return t[e][o].cellHit=!0,t[e][o].result="hit",t[e][o].ship.hit(),a(),t[e][o];return t[e][o]},allShipsSunk:a,get allSunk(){return e}}},l=(e,t)=>{let a,l;return{name:e,gameboard:o(),attackEnemy:(e,o,r)=>{if(a=o,l=r,console.log("attacking"),!0===t){if(a=Math.floor(10*Math.random()),l=Math.floor(10*Math.random()),!0===e.board[a][l].cellHit)for(;!0===e.board[a][l].cellHit;)a=Math.floor(10*Math.random()),l=Math.floor(10*Math.random());e.receiveAttack(a,l),console.log(a,l),console.log("AI is attacking")}else e.receiveAttack(a,l);return e.board[a][l]},isAI:t,get row(){return a},get col(){return l}}},r=document.querySelector("main"),n=document.createElement("form"),c=document.createElement("input"),i=document.createElement("button");c.type="text",c.name="name",c.placeholder="Enter your name",c.id="name",c.type="text",i.type="submit",i.textContent="Start Game",r.appendChild(n),n.appendChild(c),n.appendChild(i),i.addEventListener("click",(e=>{!function(e){const o=l(e,!1),r=l("Computer",!0);o.gameboard.placeShip(0,0,"horizontal",5),o.gameboard.placeShip(3,3,"horizontal",4),o.gameboard.placeShip(7,0,"vertical",3),o.gameboard.placeShip(5,8,"vertical",3),o.gameboard.placeShip(7,4,"vertical",2),r.gameboard.placeShip(0,0,"horizontal",5),r.gameboard.placeShip(3,3,"horizontal",4),r.gameboard.placeShip(7,0,"vertical",3),r.gameboard.placeShip(5,8,"vertical",3),r.gameboard.placeShip(7,4,"vertical",2),t(o),t(r),document.querySelectorAll(".enemy-cell").forEach((e=>{e.addEventListener("click",(()=>{if(o.attackEnemy(r.gameboard,Number(e.dataset.row),Number(e.dataset.col)),a(r.gameboard,Number(e.dataset.row),Number(e.dataset.col),e),console.log(r.gameboard.allSunk),!1===r.gameboard.allSunk){r.attackEnemy(o.gameboard),console.log(r.row,r.col);const e=document.querySelector(`.player-cell[data-row="${r.row}"][data-col="${r.col}"]`);console.log(e),a(o.gameboard,r.row,r.col,e)}else console.log("Game over")}),{once:!0})})),console.log(o,r)}(c.value),i.remove(),c.remove(),e.preventDefault()}))})();
//# sourceMappingURL=main.js.map